/** * Created by cyclops on 8/24/14. *//***************************** * Runs with Firefox Browser on local * Selenium standalone-server must be started before running script * Runs with firefox headless browser on server * Server OS: CentOS 6.5 * Created By Obodeh Samuel *///Array holds url and page title.var Atom ={    url:'http://dev.atom.igbimo.com/user/login',    pTitle: 'Atom Web'};var order_number;var webdriver = require('selenium-webdriver');var mocha = require('selenium-webdriver/testing');var assert = require('assert');mocha.describe('Atom - Global Search', function() {    this.timeout(100000);    mocha.it('works', function() {        var driver = new webdriver.Builder().withCapabilities(webdriver.Capabilities.firefox()).build();        driver.manage().timeouts().implicitlyWait(4000);        driver.manage().window().maximize();        console.log('');        console.log('Running Global Search');        console.log('');//Getting instance of Date and storing in @param 'tday'        var tday = new Date();        tday.toLocaleFormat;//Opens The Set Url in Atom array above        driver.get(Atom.url);//Login with credentials        driver.findElement(webdriver.By.id("UserLogin_username")).sendKeys("admin");        driver.findElement(webdriver.By.id("UserLogin_password")).sendKeys("atom");        driver.findElement(webdriver.By.name('yt0')).click();        driver.wait(function() {            return driver.getCurrentUrl().then (function(link){                if (link==='http://dev.atom.igbimo.com/home/index')                {                    console.log("Login Was Successful at " +tday);                    //Click Pickup orders Menu                    driver.findElement(webdriver.By.id('menu-dcordermanager')).click();                    //Build id for checkbox                    driver.executeScript("return jQuery('#table_pick_ticket tbody tr').first().attr('order-number')")                        .then(function(f_number){                            console.log('Order-Number: ' +f_number);                            order_number = f_number;                            if(f_number===null)                            {                                order_number = "F101";                            }                            return f_number;                        });                        driver.wait(function(){                            driver.findElement(webdriver.By.id("search_pick_ticket")).sendKeys(order_number);                            driver.findElement(webdriver.By.id("search_pick_ticket_go")).click();                            //wait for 5secs for popup to be displayed                            driver.sleep(5000);                            //Assert that popup dialog is displayed and that modal element is available                            driver.findElement(webdriver.By.css('h4.modal-title')).then(function(webElement) {                                driver.findElement(webdriver.By.css("button.close"));                                console.log("Search was performed for " +order_number +" and was successful");                            }, function(err) {                                if (err.state && err.state === 'no such element') {                                    console.log('Element not found');                                    console.log('Global Search is Broken!');                                    assert(driver.findElement(webdriver.By.css('h4.modal-title')));                                } else {                                    webdriver.promise.rejected(err);                                }                            });                            return true;                        },5000);                }                else                {                    console.error('Login Unsuccessful');                    console.error("\nAttempted Login At: " +tday);                    assert(link==='http://dev.atom.igbimo.com/home/index');                }return true;            });        },60000);        driver.quit();    });});